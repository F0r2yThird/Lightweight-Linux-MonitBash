# TG Linux Monitor

[English version](README.md)

–õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Linux —Å –∞–ª–µ—Ä—Ç–∞–º–∏ –≤ Telegram. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1 GB RAM).

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ê–ª–µ—Ä—Ç –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ CPU (`CPU_THRESHOLD`)
- –ê–ª–µ—Ä—Ç –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ RAM (`RAM_THRESHOLD`)
- –ù–µ—É—Å–ø–µ—à–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –æ–∫–Ω–µ (`ROOT_FAIL_THRESHOLD` –∑–∞ `ROOT_WINDOW_MINUTES`)
- –ê–ª–µ—Ä—Ç –Ω–∞ –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π —É—Å–ø–µ—à–Ω—ã–π SSH-–≤—Ö–æ–¥ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –≤—Ä–µ–º—è, IP)
- –ö–æ–º–∞–Ω–¥—ã –≤ Telegram:
  - `/on`
  - `/off`
  - `/status`
  - `/thresholds`
- –û–¥–∏–Ω state-—Ñ–∞–π–ª (–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, –±–µ–∑ –ë–î)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è:

```bash
cp .env.example .env
```

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
BOT_TOKEN=...
CHAT_ID=...
AUTH_USERS=root,cloud_Gj75TX
CPU_THRESHOLD=90
RAM_THRESHOLD=90
ROOT_FAIL_THRESHOLD=5
ROOT_WINDOW_MINUTES=5
SUCCESS_WINDOW_MINUTES=30
TIMEZONE=UTC+3
STATE_FILE=/var/tmp/tg_monitor_state.env
LOCK_FILE=/var/tmp/tg_monitor.lock
```

`AUTH_USERS` –∑–∞–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
git clone https://github.com/F0r2yThird/Lightweight-Linux-MonitBash.git tg-monitor
cd tg-monitor
./install.sh
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

```bash
curl -fsSL https://raw.githubusercontent.com/F0r2yThird/Lightweight-Linux-MonitBash/master/install.sh | bash
```

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `/opt/tg-monitor/.env`
2. –£–∫–∞–∑–∞—Ç—å `BOT_TOKEN`, `CHAT_ID`, `AUTH_USERS`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä—É—á–Ω—É—é:

```bash
ENV_FILE=/opt/tg-monitor/.env /opt/tg-monitor/scripts/monitor.sh
```

## Cron

`install.sh` –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–≤–µ cron-–∑–∞–ø–∏—Å–∏ (—Å —Ç–µ–≥–æ–º `# tg-monitor`):

- –∑–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

## –ö–æ–º–∞–Ω–¥—ã Telegram

- `/status` - —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç—É—Å—ã (`‚úÖ` / `üÜò`)
- `/thresholds` - –ø–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- `/off` - –æ—Ç–∫–ª—é—á–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –∞–ª–µ—Ä—Ç–æ–≤
- `/on` - –≤–∫–ª—é—á–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –∞–ª–µ—Ä—Ç–æ–≤

## –£–¥–∞–ª–µ–Ω–∏–µ

```bash
./uninstall.sh
```

–°–∫—Ä–∏–ø—Ç —É–¥–∞–ª—è–µ—Ç cron-–∑–∞–ø–∏—Å–∏ –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç `/opt/tg-monitor`.

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –°–Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–æ–±—ã—Ç–∏—è –∏–∑ `journalctl`, fallback ‚Äî `/var/log/auth.log`.
- –í—Ä–µ–º—è –≤ –∞–ª–µ—Ä—Ç–∞—Ö —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ `TIMEZONE` (`UTC+N` / `UTC-N`).
